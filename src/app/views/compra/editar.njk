{% extends "_layouts/default.njk" %} 

{% block body %}
  <div class="row"> 
      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4" id="main">  
        <div class="cadastro">
          <h3>Editar Compra</h3>
          <br>         
          <form action="/compra/editar/{{ compra._id }}" method="POST">
            <div class="row">
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="data">Data</label>
                  <input type="text" name="data" id="dtCompra"  class="flatpickr form-control" value="{{ dataCompra }}"> 
                </div>
              </div>
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="local">Local</label>
                  <input type="text" name="local" placeholder="Local" class="x form-control" value="{{ compra.local }}" maxlength="50" required>
                </div>
              </div>
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="valor">Valor</label>
                  <div class="input-group">
                    <div class="input-group-prepend">    
                      <span class="input-group-text" id="input1">R$</span>
                    </div>
                    <input type="text" id="valor" class="form-control" name="valorTotal" value='{{ compra.valorTotal }}' data-thousands="." data-decimal=","  min="0.01" readonly/>
                  </div>
                </div>
              </div>
            </div>

            <div>
              <a class="btn btn-primary col-xl-2 col-lg-3 col-md-4 mt-2" href="#" role="button" id="btnAdicionar">Adicionar Item</a>
            </div>
            <br> 

            <div id="itens">
              {% for itemCompra in itensCompra%}
                <div class="row">
                  <div class="col-md-12 col-lg-2 col-xl-1">
                    <label for="quantidade">Qtde</label>
                    <input type="number" step="0.01" name="quantidade" value="{{ itemCompra.quantidade }}" class="qtde form-control" min="0.01" required>
                  </div>
                  <div class="col-md-12 col-lg-2 col-xl-2">
                    <label for="unidadeMedida">Un. Medida</label>
                    <select name='unidadeMedida' class="unidadeMedida form-control">
                      <option value="{{ itemCompra.unidadeMedida }}" name="receita" ></option>
                    </select>
                  </div>
                  <div class="col-md-12 col-lg-2 col-xl-2">
                    <label for="insumo">Itens</label>
                    <select name='insumo' class="selectInsumo form-control">
                      <option value="{{ itemCompra.insumo }}" name="receita" class="itemInsumo"></option>
                    </select>
                  </div> 
                  <div class="col-md-12 col-lg-2 col-xl-2">
                    <label for="valor">Valor Un.</label>
                    <div class="input-group">
                      <div class="input-group-prepend">    
                        <span class="input-group-text" id="input2">R$</span>
                      </div>
                      <input type="text" class="vlr form-control" name="valor" value='{{itemCompra.valor}}' data-thousands="." data-decimal="," required/>
                    </div> 
                  </div> 
                  <div class="col-md-12 col-lg-3 col-xl-2">
                    <label for="marca">Marca</label>
                    <input type="text" name="marca" value="{{ itemCompra.marca }}" class="mrc form-control" maxlength="50" required>
                  </div> 
                  <div class="col-md-1 col-lg-1 col-xl-1 divBtnExcluirCompra">
                    <input type="button" name="btnExcluir" value="X" class="btnExcluir btn btn-danger mt-4">
                  </div>  
                </div>  
              {% else %}
                  <h4 class="mt-3">Não há itens para exibir nessa compra </h4>
              {% endfor %}
            </div>
            
            <button type="submit" class="btn btn-primary col-xl-2 col-lg-3 col-md-4 mt-4">Confirmar</button>
            <a class="btn btn-primary mt-2 col-xl-2 col-lg-3 col-md-4 mt-4 btnVoltar" href="/compra/listar" role="button">Voltar</a>

            <select class="hidden" id="insumosHidden">
              {% for insumo in insumos %}
                <option value="{{ insumo._id }}" name="receita" class="itemInsumo"> {{ insumo.nome }}</option>
              {% endfor %}
            </select>
          </form>
        </div>
      </main>
  </div> 

  <script src="/assets/js/functions/funcoesCompra.js"></script>
 
{% endblock%}  


