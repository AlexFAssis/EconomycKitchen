{% extends "_layouts/default.njk" %} 

{% block body %}
    <div class="row"> 
      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4" id="main"> 
        <div class="cadastro">
          <h3>Registro de Venda</h3>
          <br>
          <form action="/venda" method="POST">
            <div class="row">
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="data">Data</label>
                  <input type="text" name="data" id="dtVenda" class="flatpickr form-control" value={{dataVenda}} required>
                </div>
              </div>
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="usuario">Usuário</label>
                  <select name="usuario" class="form-control">
                    {% for usuario in usuarios %}
                      <option value="{{ usuario._id }}" name="usuario">{{ usuario.nome }}</option>
                    {% endfor %} 
                  </select> 
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="metodoPagamento">Método de Pagamento</label>
                  <select name="metodoPagamento" name="metodoPagamento" id="mtdoPagto" class="form-control">
                    <option value="Dinheiro" name="metodoPagamento">Dinheiro</option>
                    <option value="Credito" name="metodoPagamento">Cartão de Crédito</option>
                    <option value="Debito" name="metodoPagamento">Cartão de Débito</option>
                  </select>
                </div>
              </div>
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="qtdeParcelas">Quantidade de Parcelas</label>
                  <input type="number" name="qtdeParcelas" id="qtdeParcelas" value="1" class="form-control" maxlength="2" min="1" max="12">
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="valor">Valor</label>
                  <div class="input-group">
                    <div class="input-group-prepend">    
                      <span class="input-group-text" id="input1">R$</span>
                    </div>
                    <input type="number" name="valorTotal" step="0.01" id="vlVenda" class="form-control" value="0.00" readonly required>
                  </div>
                </div>
              </div>
              <div class="col-md-4 col-lg-3 col-xl-2">
                <div class="form-group">
                  <label for="desconto">Desconto</label>
                  <input type="text" class="form-control" name="desconto" id="desconto" data-thousands="." data-decimal="," />
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xl-4 col-lg-6 col-md-4 col-sm-8">
                  <p id="erroDesconto" class="ErrorField" style="display:none;"></p>          
              </div>
            </div>

            <div class="row" id="error">
              <div class="col-xl-4 col-lg-6 col-md-4 col-sm-8">
                {% include "_partials/flash.njk" %}
              </div>
            </div> 
           
            <a class="btn btn-primary col-md-4 col-lg-3 col-xl-2 mt-2" href="#" role="button" id="btnAdicionar">Adicionar Item</a>
          
            <br>

            <div id="itens"> 
            </div>  

            <button type="submit" class="btn btn-primary col-md-4 col-lg-2 col-xl-2 mt-2">Criar</button>

            <select class="hidden">
              {% for produto in produtos %}
                <option value="{{ produto._id }}" class="itemVenda"> {{ produto.receita.nome }}</option>
              {% endfor %}
            </select>
            <select class="hidden">
              {% for produto in produtos %}
                <option value="{{ produto._id }}" class="precoProduto"> {{ produto.preco }}</option>
              {% endfor %}
            </select>
            <br><br>

          </form>
        </div>
      </main>
    </div> 

  <script src="/assets/js/functions/funcoesVenda.js"></script>

{% endblock%}